volumes:
  - id: "os-no-swap"
    type: "vg"
    min_size: {generator: "calc_min_os_size"}
    label: "Base System"
    volumes:
      - mount: "/"
        type: "lv"
        name: "root"
        size:
          generator: "calc_total_vg"
          generator_args: ["os-no-swap"]
        file_system: "ext4"
  - id: "contrail-db"
    type: "vg"
    min_size:
      generator: "calc_gb_to_mb"
      generator_args: [10]
    label: "Contrail Database"
    volumes:
      - mount: "/var/lib/contrail_db"
        type: "lv"
        name: "cassandra"
        file_system: "ext4"
        size:
          generator: "calc_total_vg"
          generator_args: ["contrail-db"]

  - id: "crashes"
    type: "vg"
    min_size:
      generator: "calc_gb_to_mb"
      generator_args: [10]
    label: "Crash dumps"
    volumes:
      - mount: "/var/crashes"
        type: "lv"
        name: "crashes"
        size:
          generator: "calc_total_vg"
          generator_args: ["crashes"]
        file_system: "ext4"

volumes_roles_mapping:
  contrail-db:
    - {allocate_size: "min", id: "os-no-swap"}
    - {allocate_size: "min", id: "crashes"}
    - {allocate_size: "min", id: "contrail-db"}
  contrail-analytics:
    - {allocate_size: "min", id: "os"}
    - {allocate_size: "min", id: "crashes"}
    - {allocate_size: "all", id: "logs"}
  contrail-analytics-db:
    - {allocate_size: "min", id: "os"}
    - {allocate_size: "min", id: "crashes"}
    - {allocate_size: "all", id: "contrail-db"}

# NOTE(gomarivera): It might be needed to specify the partitions
# since the roles could be used in stand alone nodes.
# Furthermore, there is a lot of unallocated space left over.

  contrail-config:
    - {allocate_size: "min", id: "os-no-swap"}
    - {allocate_size: "min", id: "crashes"}
    - {allocate_size: "all", id: "logs"}
  contrail-control:
    - {allocate_size: "min", id: "os-no-swap"}
    - {allocate_size: "min", id: "crashes"}
    - {allocate_size: "all", id: "logs"}
